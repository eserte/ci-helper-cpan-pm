sudo: true

dist: trusty
language: perl
matrix:
  include:
    - perl: "5.26"
    - perl: "5.8"
    - perl: "5.24"
    - perl: "5.14"
      dist: precise
## XXX does not work yet; probably need to configure local::lib
#    - perl: "5.18"
#      os: osx
    - perl: "5.18"
      env:
        - EXTRA_TRAVIS_HELPER_CPAN_PM_OPTS="-mirrorurl https://cpan.metacpan.org/ -mirrorurl http://cpan.cpantesters.org/"
    - perl: "5.14"
    - perl: "5.10"
    - perl: "5.20-shrplib"

before_install:
  - ./travis-helper-cpan-pm --distroprefs=https://github.com/eserte/srezic-cpan-distroprefs --enable-sysdeps $EXTRA_TRAVIS_HELPER_CPAN_PM_OPTS
  - apt-get update -qq

install:
  - cpan Curses DB_File GD Imager Linux::Inotify2 Pango Tk WWW::Curl XML::LibXML
# https://rt.cpan.org/Ticket/Display.html?id=103157
  - if [ "$TRAVIS_OS_NAME" != "osx" ]; then cpan File::LibMagic; fi
  - if [[ "$TRAVIS_PERL_VERSION" != "5.8" ]] ; then cpan Prima; fi

script:
  - perl -c travis-helper-cpan-pm
  - perl -MCurses -e1
  - perl -MDB_File -e1
  - if [ "$TRAVIS_OS_NAME" != "osx" ]; then perl -MFile::LibMagic -e1; fi
  - perl -MGD -e1
  - perl -MImager -e1
  - perl -MLinux::Inotify2 -e1
  - perl -MPango -e1
## XXX fails without DISPLAY
#  - perl -MPrima -e1
  - perl -MTk -e1
  - perl -MWWW::Curl -e1
  - perl -MXML::LibXML -e1

